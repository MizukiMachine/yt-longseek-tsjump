# Chrome拡張「YouTube 長時間シーク & 現地時刻ジャンプ」要件&仕様

## 1. 目的
YouTube ライブ配信（特に24時間配信）や長尺動画で、長時間単位の巻き戻し/早送りや、現地（オランダ）時刻を指定してその瞬間へジャンプできるようにする

対象例：DVR有効live配信


## 2. 機能

### (A) 長時間シーク（早送り・巻き戻し）
- デフォルト：±10分、±30分、±60分
- キーボードショートカットで実行
  - (例)
    - Shift+J → -10分
    - Ctrl+J → -30分
    - Alt+J → -60分
    - Shift+L → +10分
    - Ctrl+L → +30分
    - Alt+L → +60分
  - ポイント
    - J/L = YouTube標準の10秒巻き戻し／早送りキー
    - 修飾キーの軽さで時間の短さを表現（Shift=軽い、Ctrl=中、Alt=重い）
  - ユーザーは `chrome://extensions/shortcuts` で変更可能
- 動作範囲は `video.seekable.start()` ～ `video.seekable.end()` にクランプ
- DVR無効時は巻き戻し不可、ライブエッジ（最新位置）より先へは進めない
- 広告中は動作しない（通知表示）



### (B) 「現地時刻ジャンプ」機能
- 入力欄に **オランダ（Europe/Amsterdam）のローカル時刻**（`HH:mm[:ss]`）を入力
- 実行すると、現地時刻に対応する再生位置へジャンプ
- **DST（サマータイム）対応**：タイムゾーン変換は `Europe/Amsterdam` 基準で計算
- 計算式（概要）
  1. 現在のライブエッジのオランダ時刻 = `NL_now`
  2. 入力値のオランダ時刻 = `NL_input`
  3. 差分 Δ = `NL_input - NL_now`（秒）
  4. `currentTime + Δ` にシーク（範囲外ならクランプ）
- **日付解決ルール**
  - 入力が未来になる場合は自動で「昨日」に切替（既定）  
    またはオプションで「Today / Yesterday」トグル選択
- DVR範囲外なら、範囲端に丸めて通知


## 3. 初期開発方針（タイムゾーン仕様）
- 初期はオランダ固定で開発
  - 実装・説明がシンプルになり、リリースまでの速度が上がる
- 要望や利用状況を見て、将来的にタイムゾーン選択機能を追加可能
  - 他国の配信やイベントにも対応し、汎用化できる
  - タイムゾーン一覧・DST対応を拡張する設計を視野に入れる


## 4. オプション設定
- 長時間シークの分数（自由設定）
- 「現地時刻ジャンプ」機能の既定動作
  - 未来入力時の自動「昨日」切替オン/オフ
  - 入力形式（HH:mm または HH:mm:ss）


## 5. 対象サイトと権限（最小権限設計）
```json
"permissions": ["commands", "storage", "scripting", "activeTab"],
"host_permissions": [
  "https://www.youtube.com/*",
  "https://www.youtube-nocookie.com/*"
]
```

* `<all_urls>` は使わない
* 必要な場合のみ追加（例：モバイル版YouTube、埋め込みプレイヤー）


## 6. セキュリティ／審査対策

* **CSP準拠**

  * JSは外部ファイル化（インライン禁止、`eval`禁止）
  * ライブラリは同梱（CDN直読み禁止）
* 外部API・データ送信なし（完全ローカル動作）
* 広告スキップやDVR無効回避など、YouTubeの制限を迂回する機能は実装しない
* ストア説明に「YouTube™ 非公式ツール」であることを明記


## 7. 動作確認チェックリスト

1. VODでの±シーク（端でクランプされる）
2. DVR有効ライブ：巻き戻し可／エッジ超え不可
3. DVR無効ライブ：巻き戻し不可、エッジ超え不可
4. 現地時刻ジャンプ：

   * オランダ時刻で正しい差分計算
   * DSTの日も正しい位置に移動
   * 未来入力時の昨日切替
   * DVR範囲外は端に丸め通知
5. 広告中は動作せず通知
6. 入力中やIME変換中はショートカット無効化


## 8. 配布方法

1. ローカル開発 → `chrome://extensions` に読み込み
2. 動作確認後、ZIP化してChrome Web Storeへアップロード
3. 公開形態：

   * **Public**：全員に検索・インストール可能
   * **Unlisted**：URLを知っている人だけ
4. 更新時はバージョン番号を上げて再アップロード（ユーザーは自動更新）

